<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">
        <i class="fas fa-shopping-cart text-mexican mr-3"></i>
        Create New Order
      </h1>
      <p class="text-gray-600">Start building your delicious Mexican meal</p>
    </div>

    <!-- Order Form Card -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
      
      <!-- Card Header -->
      <div class="bg-mexican px-6 py-4">
        <h2 class="text-xl font-semibold text-white">Order Details</h2>
      </div>

      <!-- Form Content -->
      <div class="p-6">
        <%= form_with model: @order, local: true, class: "space-y-6" do |form| %>
          
          <!-- Contact Information Section -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <!-- Contact Name -->
            <div>
              <%= form.label :contact_name, class: "block text-sm font-medium text-gray-700 mb-2" do %>
                <i class="fas fa-user text-mexican mr-2"></i>Contact Name
              <% end %>
              <%= form.text_field :contact_name, 
                  class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-mexican focus:border-transparent transition-colors",
                  placeholder: "Enter your full name",
                  value: current_user&.first_name ? "#{current_user.first_name} #{current_user.last_name}" : "" %>
            </div>

            <!-- Contact Phone -->
            <div>
              <%= form.label :contact_phone, class: "block text-sm font-medium text-gray-700 mb-2" do %>
                <i class="fas fa-phone text-mexican mr-2"></i>Phone Number
              <% end %>
              <%= form.telephone_field :contact_phone, 
                  class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-mexican focus:border-transparent transition-colors",
                  placeholder: "(555) 123-4567",
                  value: current_user&.phone %>
            </div>

          </div>

          <!-- Contact Email -->
          <div>
            <%= form.label :contact_email, class: "block text-sm font-medium text-gray-700 mb-2" do %>
              <i class="fas fa-envelope text-mexican mr-2"></i>Email Address
            <% end %>
            <%= form.email_field :contact_email, 
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-mexican focus:border-transparent transition-colors",
                placeholder: "your@email.com",
                value: current_user&.email %>
          </div>

          <!-- Order Status (Hidden, will be set by controller) -->
          <%= form.hidden_field :status, value: "pending" %>
          <%= form.hidden_field :order_date, value: Time.current %>

          <!-- Action Buttons -->
          <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200">
            <%= form.submit "Create Order & Start Shopping", 
                class: "bg-mexican text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-colors font-medium flex items-center justify-center" %>
            
            <%= link_to categories_path, 
                class: "bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors font-medium text-center" do %>
              <i class="fas fa-arrow-left mr-2"></i>Back to Menu
            <% end %>
          </div>

        <% end %>
      </div>
    </div>

    <!-- Current Order Summary (if exists) -->
    <% if session[:order_id] && current_user.orders.find_by(id: session[:order_id])&.order_items&.any? %>
      <div class="mt-8 bg-white rounded-lg shadow-lg overflow-hidden">
        <div class="bg-gray-100 px-6 py-4 border-b">
          <h3 class="text-lg font-semibold text-gray-800">
            <i class="fas fa-list text-mexican mr-2"></i>Current Order Items
          </h3>
        </div>
        
        <div class="p-6">
          <% current_order = current_user.orders.find_by(id: session[:order_id]) %>
          <% current_order.order_items.each do |item| %>
            <div class="flex justify-between items-center py-3 border-b border-gray-200 last:border-b-0">
              <div class="flex-1">
                <h4 class="font-medium text-gray-900"><%= item.item_name %></h4>
                <% if item.special_request.present? %>
                  <p class="text-sm text-gray-600 mt-1">
                    <i class="fas fa-comment text-mexican mr-1"></i>
                    <%= item.special_request %>
                  </p>
                <% end %>
              </div>
              <div class="text-right">
                <span class="font-medium text-gray-900">Qty: <%= item.quantity %></span>
                <span class="block text-mexican font-semibold">$<%= number_with_precision(item.item_price * item.quantity, precision: 2) %></span>
              </div>
            </div>
          <% end %>
          
          <div class="mt-4 pt-4 border-t border-gray-300">
            <div class="flex justify-between items-center text-lg font-semibold">
              <span>Total:</span>
              <span class="text-mexican">$<%= number_with_precision(current_order.total_amount, precision: 2) %></span>
            </div>
          </div>
          
          <div class="mt-4 flex gap-3">
            <%= link_to "Continue Shopping", categories_path, 
                class: "bg-mexican text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors" %>
            <%= link_to "Checkout", checkout_order_path(current_order), 
                class: "bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors" %>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Info Cards -->
    <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
      
      <!-- How it Works -->
      <div class="bg-white rounded-lg shadow-md p-6 text-center">
        <div class="text-mexican text-3xl mb-4">
          <i class="fas fa-utensils"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">1. Browse Menu</h3>
        <p class="text-sm text-gray-600">Explore our authentic Mexican dishes and customize your favorites.</p>
      </div>

      <!-- Add Items -->
      <div class="bg-white rounded-lg shadow-md p-6 text-center">
        <div class="text-mexican text-3xl mb-4">
          <i class="fas fa-plus-circle"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">2. Add to Order</h3>
        <p class="text-sm text-gray-600">Add items to your cart and specify any special requests.</p>
      </div>

      <!-- Complete Order -->
      <div class="bg-white rounded-lg shadow-md p-6 text-center">
        <div class="text-mexican text-3xl mb-4">
          <i class="fas fa-check-circle"></i>
        </div>
        <h3 class="font-semibold text-gray-900 mb-2">3. Complete Order</h3>
        <p class="text-sm text-gray-600">Review your order and complete your purchase.</p>
      </div>

    </div>

  </div>
</div>

<style>
  .text-mexican {
    color: #ff6b35;
  }
  .bg-mexican {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
  }
  .focus\:ring-mexican:focus {
    --tw-ring-color: #ff6b35;
  }
  .border-mexican {
    border-color: #ff6b35;
  }
</style>